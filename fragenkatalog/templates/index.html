{% extends "base.html" %}
{% load i18n %}
{% load staticfiles %}
{% load highlight %}

{% block body %}

<div class="container" style="padding-top: 20px;">
    {% for quiz in quizzes %}
    {% if forloop.first %}<div class="card-group">{% endif %}
    <div class="card border-dark mb-3 hoverable shadow-lg" style="max-width: 18rem;">

    {% if quiz.image %}
    <img class="card-img-top card-header" style="padding: 0;" src="{{ quiz.image.url }}"
         style="max-height: 30rem; object-fit: contain;">
    {% else %}
    <div class="card-header text-center text-light bg-primary">
      <span class="fas fa-question-circle" style="font-size: 100px;"></span>
    </div>
    {% endif %}
    <div class="card-body text-dark">
      <h5 class="card-title">
          {% if search %}
          {{ quiz.title|highlight:search }}
          {% else %}
          {{ quiz.title }}
          {% endif %}
      </h5>
      <p class="card-text">
          {% if search %}
          {{ quiz.description|highlight:search }}
          {% else %}
          {{ quiz.description }}
          {% endif %}
      </p>
    {% if quiz.textualquestion_set.count > 0 %}
        <span class="card-text badge badge-secondary">
          {{ quiz.textualquestion_set.count }} question{{ quiz.textualquestion_set.count|pluralize:"s" }}
        </span>
    {% endif %}
    {% for hashtag in quiz.hashtag_set %}
        <span class="card-text badge badge-secondary">
          {% if search %}
          {{ hashtag|highlight:search }}
          {% else %}
          {{ hashtag }}
          {% endif %}
        </span>
    {% endfor %}
      <p class="card-text">
        <small class="text-muted">
          {% blocktrans with time=quiz.pubdate|timesince %}
          Published {{ time }} ago.
          {% endblocktrans %}
        </small>
      </p>
      {% if quiz.textualquestion_set.count > 0 %}
        <a class="btn btn-outline-primary" href="{% url 'questionnaire' quiz.id %}">
            Show
        </a>
      {% else %}
        <btn class="btn btn-outline-secondary" disabled>Coming soon</btn>
      {% endif %}
    </div>
    </div>
    {% if forloop.counter|divisibleby:4 %}</div><div class="card-group">{% endif %}
    {% if forloop.last %}</div>{% endif %}
    {% endfor %}
</div>

{% endblock %}

{% block extrabody %}
{% if user.is_authenticated and user.is_superuser %}
<script>
$(".confirmation-needed").click(function(e) {
    if (!confirm("Do you really want to do this?")) {
        e.preventDefault();
    }
});
</script>
{% endif %}
{% endblock %}